<div class="notification-preferences">
  <div class="preferences-header">
    <h1 class="page-title">Notification Preferences</h1>
    <p class="page-subtitle">Manage how you receive notifications</p>
  </div>

  <div class="preferences-content" *ngIf="!isLoading()">
    <!-- Success Message -->
    <div class="success-message" *ngIf="showSuccessMessage()">
      <i class="bi bi-check-circle"></i>
      <span>Preferences saved successfully!</span>
    </div>

    <!-- Notification Types -->
    <div class="preferences-section">
      <h2 class="section-title">Notification Types</h2>
      <div class="preferences-grid">
        <div class="preference-item">
          <div class="preference-info">
            <h3 class="preference-title">Email Notifications</h3>
            <p class="preference-description">Receive notifications via email</p>
          </div>
          <div class="preference-control">
            <label class="toggle-switch">
              <input 
                type="checkbox" 
                [checked]="preferences()?.emailNotifications"
                (change)="updatePreference('emailNotifications', $event.target.checked)"
              >
              <span class="toggle-slider"></span>
            </label>
          </div>
        </div>

        <div class="preference-item">
          <div class="preference-info">
            <h3 class="preference-title">Push Notifications</h3>
            <p class="preference-description">Receive push notifications in your browser</p>
          </div>
          <div class="preference-control">
            <label class="toggle-switch">
              <input 
                type="checkbox" 
                [checked]="preferences()?.pushNotifications"
                (change)="updatePreference('pushNotifications', $event.target.checked)"
              >
              <span class="toggle-slider"></span>
            </label>
          </div>
        </div>

        <div class="preference-item">
          <div class="preference-info">
            <h3 class="preference-title">SMS Notifications</h3>
            <p class="preference-description">Receive notifications via SMS</p>
          </div>
          <div class="preference-control">
            <label class="toggle-switch">
              <input 
                type="checkbox" 
                [checked]="preferences()?.smsNotifications"
                (change)="updatePreference('smsNotifications', $event.target.checked)"
              >
              <span class="toggle-slider"></span>
            </label>
          </div>
        </div>
      </div>
    </div>

    <!-- Specific Notifications -->
    <div class="preferences-section">
      <h2 class="section-title">Specific Notifications</h2>
      <div class="preferences-grid">
        <div class="preference-item">
          <div class="preference-info">
            <h3 class="preference-title">Appointment Reminders</h3>
            <p class="preference-description">Get reminded about upcoming appointments</p>
          </div>
          <div class="preference-control">
            <label class="toggle-switch">
              <input 
                type="checkbox" 
                [checked]="preferences()?.appointmentReminders"
                (change)="updatePreference('appointmentReminders', $event.target.checked)"
              >
              <span class="toggle-slider"></span>
            </label>
          </div>
        </div>

        <div class="preference-item">
          <div class="preference-info">
            <h3 class="preference-title">Prescription Alerts</h3>
            <p class="preference-description">Get notified when prescriptions are ready</p>
          </div>
          <div class="preference-control">
            <label class="toggle-switch">
              <input 
                type="checkbox" 
                [checked]="preferences()?.prescriptionAlerts"
                (change)="updatePreference('prescriptionAlerts', $event.target.checked)"
              >
              <span class="toggle-slider"></span>
            </label>
          </div>
        </div>

        <div class="preference-item">
          <div class="preference-info">
            <h3 class="preference-title">Test Result Alerts</h3>
            <p class="preference-description">Get notified when test results are available</p>
          </div>
          <div class="preference-control">
            <label class="toggle-switch">
              <input 
                type="checkbox" 
                [checked]="preferences()?.testResultAlerts"
                (change)="updatePreference('testResultAlerts', $event.target.checked)"
              >
              <span class="toggle-slider"></span>
            </label>
          </div>
        </div>

        <div class="preference-item">
          <div class="preference-info">
            <h3 class="preference-title">System Updates</h3>
            <p class="preference-description">Get notified about system updates and maintenance</p>
          </div>
          <div class="preference-control">
            <label class="toggle-switch">
              <input 
                type="checkbox" 
                [checked]="preferences()?.systemUpdates"
                (change)="updatePreference('systemUpdates', $event.target.checked)"
              >
              <span class="toggle-slider"></span>
            </label>
          </div>
        </div>

        <div class="preference-item">
          <div class="preference-info">
            <h3 class="preference-title">Marketing Emails</h3>
            <p class="preference-description">Receive promotional and marketing emails</p>
          </div>
          <div class="preference-control">
            <label class="toggle-switch">
              <input 
                type="checkbox" 
                [checked]="preferences()?.marketingEmails"
                (change)="updatePreference('marketingEmails', $event.target.checked)"
              >
              <span class="toggle-slider"></span>
            </label>
          </div>
        </div>
      </div>
    </div>

    <!-- Timing Settings -->
    <div class="preferences-section">
      <h2 class="section-title">Timing Settings</h2>
      <div class="preferences-grid">
        <div class="preference-item">
          <div class="preference-info">
            <h3 class="preference-title">Reminder Time</h3>
            <p class="preference-description">How many minutes before appointment to send reminder</p>
          </div>
          <div class="preference-control">
            <select 
              class="preference-select"
              [value]="preferences()?.reminderTime"
              (change)="updatePreference('reminderTime', +$event.target.value)"
            >
              <option value="5">5 minutes</option>
              <option value="15">15 minutes</option>
              <option value="30">30 minutes</option>
              <option value="60">1 hour</option>
              <option value="120">2 hours</option>
              <option value="1440">1 day</option>
            </select>
          </div>
        </div>

        <div class="preference-item">
          <div class="preference-info">
            <h3 class="preference-title">Quiet Hours Start</h3>
            <p class="preference-description">When to stop sending notifications</p>
          </div>
          <div class="preference-control">
            <input 
              type="time" 
              class="preference-input"
              [value]="preferences()?.quietHoursStart"
              (change)="updatePreference('quietHoursStart', $event.target.value)"
            >
          </div>
        </div>

        <div class="preference-item">
          <div class="preference-info">
            <h3 class="preference-title">Quiet Hours End</h3>
            <p class="preference-description">When to resume sending notifications</p>
          </div>
          <div class="preference-control">
            <input 
              type="time" 
              class="preference-input"
              [value]="preferences()?.quietHoursEnd"
              (change)="updatePreference('quietHoursEnd', $event.target.value)"
            >
          </div>
        </div>

        <div class="preference-item">
          <div class="preference-info">
            <h3 class="preference-title">Timezone</h3>
            <p class="preference-description">Your local timezone</p>
          </div>
          <div class="preference-control">
            <select 
              class="preference-select"
              [value]="preferences()?.timezone"
              (change)="updatePreference('timezone', $event.target.value)"
            >
              <option value="UTC">UTC</option>
              <option value="America/New_York">Eastern Time</option>
              <option value="America/Chicago">Central Time</option>
              <option value="America/Denver">Mountain Time</option>
              <option value="America/Los_Angeles">Pacific Time</option>
              <option value="Europe/London">London</option>
              <option value="Europe/Paris">Paris</option>
              <option value="Asia/Tokyo">Tokyo</option>
            </select>
          </div>
        </div>
      </div>
    </div>

    <!-- Actions -->
    <div class="preferences-actions">
      <button class="btn btn-secondary" (click)="resetToDefaults()">
        <i class="bi bi-arrow-clockwise"></i>
        Reset to Defaults
      </button>
      <button 
        class="btn btn-primary" 
        (click)="savePreferences()"
        [disabled]="isSaving()"
      >
        <i class="bi bi-check" *ngIf="!isSaving()"></i>
        <i class="bi bi-arrow-clockwise bi-spin" *ngIf="isSaving()"></i>
        {{ isSaving() ? 'Saving...' : 'Save Preferences' }}
      </button>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading()" class="loading-state">
    <div class="loading-spinner">
      <i class="bi bi-arrow-clockwise bi-spin"></i>
    </div>
    <p>Loading notification preferences...</p>
  </div>
</div>

