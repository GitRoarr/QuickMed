<app-patient-shell active="records">
  <div class="records-page">
    <div class="page-header">
      <div>
        <p class="eyebrow">Medical Records</p>
        <h1>View and manage your medical history</h1>
      </div>
    </div>

    <div class="stats-row" *ngIf="!isLoading()">
      <div class="stat-card">
        <p>Total Records</p>
        <h2>{{ totalRecords() }}</h2>
      </div>
      <div class="stat-card">
        <p>Lab Results</p>
        <h2>{{ labCount() }}</h2>
      </div>
      <div class="stat-card">
        <p>Prescriptions</p>
        <h2>{{ prescriptionCount() }}</h2>
      </div>
      <div class="stat-card">
        <p>Imaging</p>
        <h2>{{ imagingCount() }}</h2>
      </div>
      <div class="stat-card">
        <p>Diagnoses</p>
        <h2>{{ diagnosisCount() }}</h2>
      </div>
    </div>

    <div class="filter-bar" *ngIf="!isLoading()">
      <div class="filter-label">
        <img
          class="filter-icon"
          src="https://img.icons8.com/?size=100&id=3720&format=png&color=000000"
          alt="Filter records"
        />
        <span>Filter records</span>
      </div>
      <div class="filter-chips">
        <button
          type="button"
          class="filter-chip"
          *ngFor="let option of filterOptions"
          [class.active]="filterType() === option.value"
          (click)="setFilter(option.value)"
        >
          {{ option.label }}
        </button>
      </div>
    </div>

    <div class="records-list" *ngIf="!isLoading(); else loadingState">
      <div class="record-card" *ngFor="let record of filteredRecords()">
        <div>
          <p class="record-title">{{ record.title }}</p>
          <p class="muted">{{ record.recordDate | date:'MMM d, y' }}</p>
          <span class="tag">{{ record.type }}</span>
        </div>
        <div class="record-actions">
          <button class="text-btn" (click)="viewRecord(record)">View</button>
          <button class="primary-btn subtle" (click)="downloadRecord(record)">Download</button>
        </div>
      </div>

      <div class="empty-state" *ngIf="filteredRecords().length === 0">
        <p>No records match this filter.</p>
      </div>
    </div>
  </div>
</app-patient-shell>

<ng-template #loadingState>
  <div class="empty-state">
    <div class="spinner"></div>
    Loading records...
  </div>
</ng-template>

