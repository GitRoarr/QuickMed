<div class="auth-container">
  <div class="auth-wrapper">
    <div class="auth-header text-center">
      <div class="logo-container">
        <div class="logo-icon">
          <i class="bi bi-activity"></i>
        </div>
        <h1 class="logo-text">QuickMed</h1>
      </div>
      <p class="portal-label">Reset Your Password</p>
    </div>

    <div class="auth-card">
      <div class="auth-card-header">
        <div class="user-icon-wrapper">
          <div class="user-icon">
            <i class="bi bi-key"></i>
          </div>
        </div>
        <h2 class="auth-title">Forgot Password?</h2>
        <p class="auth-subtitle" *ngIf="!emailSent">
          Enter your email address and we'll send you instructions to reset your password.
        </p>
        <p class="auth-subtitle" *ngIf="emailSent">
          Check your email for password reset instructions.
        </p>
      </div>

      <form [formGroup]="forgotPasswordForm" (ngSubmit)="onSubmit()" *ngIf="!emailSent">
        <app-alert-message #alert [message]="errorMessage" type="error" [autoDismiss]="true" [duration]="5000" *ngIf="errorMessage"></app-alert-message>

        <div class="form-group">
          <label for="email" class="form-label">
            <i class="bi bi-envelope me-2"></i>Email Address
          </label>
          <input
            type="email"
            class="form-control"
            id="email"
            formControlName="email"
            placeholder="your.email@example.com"
            [class.is-invalid]="forgotPasswordForm.get('email')?.invalid && forgotPasswordForm.get('email')?.touched"
          />
          <div class="invalid-feedback" *ngIf="forgotPasswordForm.get('email')?.invalid && forgotPasswordForm.get('email')?.touched">
            Please enter a valid email address
          </div>
        </div>

        <div class="form-footer">
          <a (click)="backToLogin()" class="back-link" style="cursor: pointer;">
            <i class="bi bi-arrow-left me-2"></i> Back to Login
          </a>
        </div>

        <button type="submit" class="btn btn-primary btn-submit" [disabled]="isLoading">
          <span *ngIf="isLoading" class="spinner-border spinner-border-sm me-2"></span>
          {{ isLoading ? "Sending..." : "Send Reset Link" }}
          <i *ngIf="!isLoading" class="bi bi-send ms-2"></i>
        </button>
      </form>

      <div *ngIf="emailSent" class="success-message">
        <app-alert-message #alert [message]="successMessage" type="success" [autoDismiss]="false"></app-alert-message>
        
        <div class="text-center mt-4">
          <p class="mb-3">Didn't receive the email? Check your spam folder or try again.</p>
          <button type="button" class="btn btn-secondary" (click)="emailSent = false; forgotPasswordForm.reset();">
            <i class="bi bi-arrow-counterclockwise me-2"></i> Try Again
          </button>
        </div>

        <div class="form-footer mt-4">
          <a (click)="backToLogin()" class="back-link" style="cursor: pointer;">
            <i class="bi bi-arrow-left me-2"></i> Back to Login
          </a>
        </div>
      </div>

      <div class="text-center mt-4" *ngIf="!emailSent">
        <p class="switch-auth">
          Remember your password?
          <a routerLink="/login" class="auth-link">Sign in</a>
        </p>
      </div>
    </div>
  </div>
</div>
