<div class="auth-container">
  <div class="auth-wrapper">
    <!-- Branding Section -->
    <div class="auth-header text-center">
      <div class="logo-container-main" routerLink="/">
        <div class="logo-circular">
          <img src="assets/images/QuickMed-Logo-Light.png" alt="QuickMed logo" class="premium-logo-img" />
        </div>
      </div>
      <p class="portal-label">Reset Your Password</p>
    </div>

    <div class="auth-card">
      <div class="auth-card-body">
        <div class="icon-section">
          <div class="status-icon-box">
            <i class="bi bi-key-fill"></i>
          </div>
        </div>

        <h2 class="auth-title">Forgot Password?</h2>

        <!-- Initial Form State -->
        <form [formGroup]="forgotPasswordForm" (ngSubmit)="onSubmit()" *ngIf="!emailSent">
          <p class="auth-subtitle">
            Enter your email address and we'll send you instructions to reset your password.
          </p>

          <app-alert-message #alert [message]="errorMessage" type="error" [autoDismiss]="true" [duration]="5000"
            *ngIf="errorMessage"></app-alert-message>

          <div class="form-group mb-4">
            <div class="input-modern-wrapper">
              <i class="bi bi-envelope"></i>
              <input type="email" class="form-control-modern" formControlName="email" placeholder="Email Address"
                [class.is-invalid]="forgotPasswordForm.get('email')?.invalid && forgotPasswordForm.get('email')?.touched" />
            </div>
          </div>

          <button type="submit" class="btn-modern btn-primary-modern w-100 mb-4" [disabled]="isLoading">
            <span *ngIf="isLoading" class="spinner-border spinner-border-sm me-2"></span>
            {{ isLoading ? "Sending..." : "Send Reset Link" }}
          </button>
        </form>

        <!-- Success State (Matching Image) -->
        <div *ngIf="emailSent" class="success-state">
          <p class="auth-subtitle success-text">
            Check your email for password reset instructions.
          </p>

          <div class="help-section">
            <p>Didn't receive the email? Check your spam folder or try again.</p>
          </div>

          <button type="button" class="btn-modern btn-refresh-modern mb-4"
            (click)="emailSent = false; forgotPasswordForm.reset();">
            <i class="bi bi-arrow-clockwise"></i> Try Again
          </button>
        </div>

        <div class="back-to-login">
          <a (click)="backToLogin()" class="link-back">
            <i class="bi bi-arrow-left"></i> Back to Login
          </a>
        </div>
      </div>
    </div>
  </div>
</div>