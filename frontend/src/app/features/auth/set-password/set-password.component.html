<div class="set-password-container">
  <div class="auth-card">
    <div class="brand-section">
      <div class="brand-logo">
        <i class="bi bi-shield-lock-fill"></i>
      </div>
      <h2 class="title">Secure Your Account</h2>
      <p class="subtitle">Set a strong password for your doctor access</p>
    </div>

    <div *ngIf="message" class="alert-box" [ngClass]="type === 'success' ? 'alert-success' : 'alert-error'">
      <i class="bi" [class.bi-check-circle-fill]="type === 'success'"
        [class.bi-exclamation-triangle-fill]="type === 'error'"></i>
      <span>{{ message }}</span>
    </div>

    <form [formGroup]="form" (ngSubmit)="onSubmit()">
      <div class="form-group">
        <label for="password">New Password</label>
        <div class="input-container">
          <input id="password" type="password" formControlName="password" placeholder="At least 8 characters"
            [class.error]="form.get('password')?.invalid && form.get('password')?.touched" />
          <i class="bi bi-lock"></i>
        </div>
        <div *ngIf="form.get('password')?.invalid && form.get('password')?.touched" class="error-msg">
          <i class="bi bi-info-circle"></i>
          <span *ngIf="form.get('password')?.errors?.['required']">Password is required</span>
          <span *ngIf="form.get('password')?.errors?.['minlength']">Must be at least 8 characters</span>
        </div>
      </div>

      <div class="form-group">
        <label for="confirmPassword">Confirm Password</label>
        <div class="input-container">
          <input id="confirmPassword" type="password" formControlName="confirmPassword"
            placeholder="Re-enter your password"
            [class.error]="form.get('confirmPassword')?.invalid && form.get('confirmPassword')?.touched" />
          <i class="bi bi-lock-check"></i>
        </div>
        <div *ngIf="form.get('confirmPassword')?.hasError('passwordMismatch') && form.get('confirmPassword')?.touched"
          class="error-msg">
          <i class="bi bi-exclamation-circle"></i>
          Passwords do not match
        </div>
      </div>

      <button type="submit" class="submit-btn" [disabled]="form.invalid || loading || !token || !uid">
        <span *ngIf="!loading">Set Password & Login</span>
        <div *ngIf="loading" class="spinner"></div>
      </button>
    </form>
  </div>
</div>