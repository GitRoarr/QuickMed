<div class="md-admin-page">
  <div class="md-admin-container">
    <!-- Theme Toggle -->
    <button class="md-theme-toggle" (click)="themeService.toggleTheme()"
      [title]="themeService.isDarkMode() ? 'Switch to Light Mode' : 'Switch to Dark Mode'">
      <i class="bi" [class.bi-sun-fill]="!themeService.isDarkMode()"
        [class.bi-moon-stars-fill]="themeService.isDarkMode()"></i>
    </button>

    <!-- Header Section -->
    <div class="md-header">
      <h1 class="md-title">Add New Doctor</h1>
      <p class="md-subtitle">Create and manage physician profiles and credentials</p>
    </div>

    <!-- Centered Card -->
    <div class="md-card">
      <form [formGroup]="form" (ngSubmit)="submit()" class="md-form">

        <!-- Grid Layout -->
        <div class="md-grid">

          <!-- Left Column: Personal & Basic Info -->
          <div class="md-col">
            <div class="md-section">
              <div class="md-section-header">
                <i class="bi bi-person-circle"></i>
                <span>Personal Information</span>
              </div>

              <div class="md-field">
                <label for="firstName">First Name</label>
                <div class="md-input-group">
                  <i class="bi bi-person"></i>
                  <input type="text" id="firstName" formControlName="firstName" placeholder="Enter first name"
                    [class.error]="form.get('firstName')?.invalid && form.get('firstName')?.touched">
                </div>
              </div>

              <div class="md-field">
                <label for="email">Email Address</label>
                <div class="md-input-group">
                  <i class="bi bi-envelope"></i>
                  <input type="email" id="email" formControlName="email" placeholder="doctor@example.com"
                    [class.error]="form.get('email')?.invalid && form.get('email')?.touched">
                </div>
              </div>

              <div class="md-field">
                <label for="specialty">Specialty</label>
                <div class="md-input-group">
                  <i class="bi bi-briefcase"></i>
                  <input type="text" id="specialty" formControlName="specialty" placeholder="e.g. Cardiology"
                    [class.error]="form.get('specialty')?.invalid && form.get('specialty')?.touched">
                </div>
              </div>

              <div class="md-field">
                <label for="phoneNumber">Phone Number</label>
                <div class="md-input-group">
                  <i class="bi bi-telephone"></i>
                  <input type="tel" id="phoneNumber" formControlName="phoneNumber" placeholder="+1 (555) 000-0000"
                    [class.error]="form.get('phoneNumber')?.invalid && form.get('phoneNumber')?.touched">
                </div>
              </div>
            </div>
          </div>

          <!-- Right Column: Professional Info & Bio -->
          <div class="md-col">
            <div class="md-section">
              <div class="md-section-header">
                <i class="bi bi-shield-check"></i>
                <span>Professional Details</span>
              </div>

              <div class="md-field">
                <label for="lastName">Last Name</label>
                <div class="md-input-group">
                  <i class="bi bi-person"></i>
                  <input type="text" id="lastName" formControlName="lastName" placeholder="Enter last name"
                    [class.error]="form.get('lastName')?.invalid && form.get('lastName')?.touched">
                </div>
              </div>

              <div class="md-field">
                <label for="licenseNumber">License Number</label>
                <div class="md-input-group">
                  <i class="bi bi-card-text"></i>
                  <input type="text" id="licenseNumber" formControlName="licenseNumber" placeholder="MD-XXXXXXX"
                    [class.error]="form.get('licenseNumber')?.invalid && form.get('licenseNumber')?.touched">
                </div>
              </div>

              <div class="md-field">
                <label for="bio">Bio / Description <span class="optional-badge">(Optional)</span></label>
                <div class="md-input-group textarea-group">
                  <i class="bi bi-chat-left-text"></i>
                  <textarea id="bio" formControlName="bio"
                    placeholder="Describe the doctor's professional experience and background..."
                    [class.error]="form.get('bio')?.invalid && form.get('bio')?.touched"></textarea>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Action Buttons -->
        <div class="md-actions">
          <button type="button" class="md-btn md-btn-secondary" (click)="back()">
            <i class="bi bi-arrow-left"></i>
            {{ (inviteLink || emailSent) ? 'Go Back' : 'Cancel' }}
          </button>
          <button type="submit" class="md-btn md-btn-primary" [disabled]="form.invalid || loading">
            <span *ngIf="!loading">
              <i class="bi bi-check2-circle"></i>
              Save & Invite Doctor
            </span>
            <span *ngIf="loading" class="spinner-inline"></span>
          </button>
        </div>
      </form>
    </div>

    <!-- Invite Link (if applicable) -->
    <div *ngIf="inviteLink" class="md-status-card">
      <div class="md-status-content">
        <i class="bi bi-link-45deg"></i>
        <div class="md-status-text">
          <p class="md-status-title">Invitation Link Generated</p>
          <p class="md-status-desc">Copy and share this link with the doctor.</p>
        </div>
        <div class="md-copy-box">
          <input type="text" [value]="inviteLink" readonly (click)="copyInviteLink()">
          <div class="md-box-actions">
            <button type="button" class="view-link-btn" (click)="viewInviteLink()" title="View Invitation Page">
              <i class="bi bi-eye"></i>
            </button>
            <button type="button" (click)="copyInviteLink()">
              <i class="bi bi-clipboard"></i>
              Copy Link
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>