<div class="admin-layout">
  <aside class="sidebar">
    <div class="sidebar-header">
      <div class="logo-section">
        <div class="logo-container">
          <svg width="32" height="32" viewBox="0 0 40 40" fill="none">
            <rect width="40" height="40" rx="8" fill="url(#adminGradient)"/>
            <path d="M20 10L28 16V24L20 30L12 24V16L20 10Z" fill="white"/>
            <defs>
              <linearGradient id="adminGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" style="stop-color:#dc2626;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#ef4444;stop-opacity:1" />
              </linearGradient>
            </defs>
          </svg>
        </div>
        <div class="brand">
          <div class="brand-name">QuickMed</div>
          <div class="brand-subtitle">Admin Portal</div>
        </div>
      </div>
      <button class="theme-toggle" (click)="toggleTheme()" title="Toggle Theme">
        <i class="bi" [class.bi-sun]="!isDarkMode()" [class.bi-moon]="isDarkMode()"></i>
      </button>
    </div>

    <!-- Quick Stats -->
    <div class="quick-stats">
      <div class="stat-item">
        <div class="stat-number">{{ quickStats().totalAppointments }}</div>
        <div class="stat-label">Appointments</div>
      </div>
      <div class="stat-item">
        <div class="stat-number">{{ quickStats().totalPatients }}</div>
        <div class="stat-label">Patients</div>
      </div>
      <div class="stat-item">
        <div class="stat-number">{{ quickStats().totalDoctors }}</div>
        <div class="stat-label">Doctors</div>
      </div>
    </div>

    <nav class="sidebar-nav">
      <div class="nav-section">
        <div class="nav-section-title">Main</div>
        <a
          *ngFor="let item of menuItems"
          [routerLink]="item.route"
          routerLinkActive="active"
          class="nav-item"
          [class.has-submenu]="item.submenu"
          (click)="item.submenu && toggleSubmenu(item)"
        >
          <span class="nav-icon">
            <i class="bi {{ item.icon }}"></i>
          </span>
          <span class="nav-label">{{ item.label }}</span>
          <i 
            *ngIf="item.submenu" 
            class="bi bi-chevron-down submenu-arrow"
            [class.rotated]="item.expanded"
          ></i>
        </a>
      </div>

      <div class="submenu" *ngFor="let item of menuItems">
        <div *ngIf="item.submenu && item.expanded" class="submenu-items">
          <a
            *ngFor="let subItem of item.submenu"
            [routerLink]="subItem.route"
            routerLinkActive="active"
            class="submenu-item"
          >
            <i class="bi {{ subItem.icon }}"></i>
            {{ subItem.label }}
          </a>
        </div>
      </div>
    </nav>

    <div class="sidebar-footer">
      <div class="user-info">
        <div class="user-avatar">{{ getInitials(currentUser()?.firstName, currentUser()?.lastName) }}</div>
        <div class="user-details">
          <div class="user-name">{{ currentUser()?.firstName }} {{ currentUser()?.lastName }}</div>
          <div class="user-role">{{ getUserRole() }}</div>
        </div>
      </div>
    </div>
  </aside>

  <div class="main-wrapper">
    <header class="top-header">
      <div class="search-bar">
        <i class="bi bi-search search-icon"></i>
        <input 
          type="text" 
          placeholder="Search patients, appointments, doctors..." 
          [(ngModel)]="searchQuery"
          (ngModelChange)="onSearchChange()"
          class="search-input"
        />
        <div class="search-shortcut">Ctrl+K</div>
      </div>

      <div class="header-actions">
        <div class="quick-actions">
          <button class="quick-action-btn" (click)="createNewAppointment()" title="New Appointment (Ctrl+N)">
            <i class="bi bi-plus-circle"></i>
          </button>
          <button class="quick-action-btn" (click)="toggleTheme()" title="Toggle Theme (Ctrl+D)">
            <i class="bi" [class.bi-sun]="!isDarkMode()" [class.bi-moon]="isDarkMode()"></i>
          </button>
        </div>

        <div class="notification-dropdown">
          <button 
            class="notification-btn" 
            (click)="toggleNotifications()"
            [class.has-notifications]="unreadCount() > 0"
          >
            <i class="bi bi-bell"></i>
            <span class="notification-badge" *ngIf="unreadCount() > 0">{{ unreadCount() }}</span>
          </button>

          <div class="notification-panel" *ngIf="showNotifications()">
            <div class="notification-header">
              <h3>Notifications</h3>
              <button class="mark-all-read" (click)="markAllNotificationsAsRead()">
                Mark all read
              </button>
            </div>
            <div class="notification-list">
              <div 
                *ngFor="let notification of notifications" 
                class="notification-item"
                [class.unread]="!notification.read"
                (click)="markNotificationAsRead(notification.id)"
              >
                <div class="notification-icon" [class]="'type-' + notification.type">
                  <i class="bi" [class]="getNotificationIcon(notification.type)"></i>
                </div>
                <div class="notification-content">
                  <div class="notification-title">{{ notification.title }}</div>
                  <div class="notification-message">{{ notification.message }}</div>
                  <div class="notification-time">{{ notification.timestamp | date:'short' }}</div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="user-dropdown">
          <button class="user-btn" (click)="toggleUserMenu()">
            <div class="user-avatar">{{ getInitials(currentUser()?.firstName, currentUser()?.lastName) }}</div>
            <div class="user-info">
              <div class="user-name">{{ currentUser()?.firstName }} {{ currentUser()?.lastName }}</div>
              <div class="user-role">{{ getUserRole() }}</div>
            </div>
            <i class="bi bi-chevron-down"></i>
          </button>

          <div class="user-menu" *ngIf="showUserMenu()">
            <a class="user-menu-item" (click)="navigateToProfile()">
              <i class="bi bi-person"></i>
              Profile
            </a>
            <a class="user-menu-item" (click)="navigateToSettings()">
              <i class="bi bi-gear"></i>
              Settings
            </a>
            <div class="user-menu-divider"></div>
            <a class="user-menu-item logout" (click)="logout()">
              <i class="bi bi-box-arrow-right"></i>
              Logout
            </a>
          </div>
        </div>
      </div>
    </header>

    <main class="main-content">
      <ng-content></ng-content>
    </main>
  </div>

  <div class="backdrop" *ngIf="showNotifications() || showUserMenu()" (click)="showNotifications.set(false); showUserMenu.set(false)"></div>

  
<div class="profile-modal" *ngIf="showProfileModal">
  <div class="profile-modal-content">
    <h3>Edit Profile</h3>
    <label>First Name</label>
    <input [(ngModel)]="editFirstName" type="text" class="form-control" />

    <label>Last Name</label>
    <input [(ngModel)]="editLastName" type="text" class="form-control" />

    <div class="modal-actions">
      <button (click)="saveProfile()">Save</button>
      <button (click)="cancelProfileEdit()">Cancel</button>
    </div>
  </div>
</div>

</div>
