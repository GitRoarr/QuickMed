<div class="doctor-settings">
  <!-- Sidebar -->
  <app-doctor-sidebar></app-doctor-sidebar>

  <!-- Main Content -->
  <main class="main-content">
    <div class="doctor-topbar">
      <div class="doctor-topbar-actions">
        <button class="icon-btn" [routerLink]="'/doctor/messages'" title="Messages">
          <i class="bi bi-chat-dots"></i>
        </button>
        <button class="icon-btn" [routerLink]="'/doctor/notifications'" title="Notifications">
          <i class="bi bi-bell"></i>
        </button>
        <button class="icon-btn" (click)="setTheme('light')"><i class="bi bi-brightness-high"></i></button>
        <button class="icon-btn" (click)="setTheme('dark')"><i class="bi bi-moon"></i></button>
        <div class="avatar-sm">
          <img *ngIf="currentUser()?.avatar; else docSmall" [src]="currentUser()?.avatar" alt="Doctor" />
          <ng-template #docSmall>{{ getDoctorInitials() }}</ng-template>
        </div>
      </div>
    </div>
    <header class="content-header">
      <div>
        <h1 class="page-title">Settings</h1>
        <p class="page-subtitle">Manage your account settings and preferences</p>
      </div>
    </header>

    <div class="settings-container">
      <!-- Settings Navigation -->
      <nav class="settings-nav">
        <button
          class="nav-tab"
          [class.active]="activeTab() === 'profile'"
          (click)="activeTab.set('profile')"
        >
          <i class="bi bi-person"></i>
          Profile
        </button>
        <button
          class="nav-tab"
          [class.active]="activeTab() === 'notifications'"
          (click)="activeTab.set('notifications')"
        >
          <i class="bi bi-bell"></i>
          Notifications
        </button>
        <button
          class="nav-tab"
          [class.active]="activeTab() === 'availability'"
          (click)="activeTab.set('availability')"
        >
          <i class="bi bi-clock"></i>
          Availability
        </button>
        <button
          class="nav-tab"
          [class.active]="activeTab() === 'billing'"
          (click)="activeTab.set('billing')"
        >
          <i class="bi bi-currency-dollar"></i>
          Billing
        </button>
        <button
          class="nav-tab"
          [class.active]="activeTab() === 'privacy'"
          (click)="activeTab.set('privacy')"
        >
          <i class="bi bi-shield-lock"></i>
          Privacy & Security
        </button>
      </nav>

      <!-- Settings Content -->
      <div class="settings-content">
        <!-- Profile Tab -->
        <div *ngIf="activeTab() === 'profile'" class="settings-section">
          <h2 class="section-title">Profile Information</h2>
          <div class="profile-photo-section">
            <div class="photo-placeholder">
              {{ getDoctorInitials() }}
            </div>
            <button class="change-photo-btn">Change Photo</button>
            <p class="photo-hint">JPG, PNG or GIF, Max 5MB.</p>
          </div>

          <div class="form-grid">
            <div class="form-group">
              <label>First Name</label>
              <input type="text" [(ngModel)]="profileForm.firstName" />
            </div>
            <div class="form-group">
              <label>Last Name</label>
              <input type="text" [(ngModel)]="profileForm.lastName" />
            </div>
            <div class="form-group">
              <label>Email</label>
              <input type="email" [(ngModel)]="profileForm.email" readonly />
            </div>
            <div class="form-group">
              <label>Phone</label>
              <input type="tel" [(ngModel)]="profileForm.phoneNumber" />
            </div>
            <div class="form-group">
              <label>Specialization</label>
              <input type="text" [(ngModel)]="profileForm.specialty" />
            </div>
            <div class="form-group">
              <label>Medical License</label>
              <input type="text" [(ngModel)]="profileForm.licenseNumber" />
            </div>
          </div>

          <div class="form-group">
            <label>Professional Bio</label>
            <textarea
              rows="4"
              [(ngModel)]="profileForm.bio"
              placeholder="Board-certified cardiologist with 12 years of experience..."
            ></textarea>
          </div>

          <h2 class="section-title">Office Information</h2>
          <div class="form-grid">
            <div class="form-group">
              <label>Office Address</label>
              <input type="text" [(ngModel)]="profileForm.officeAddress" />
            </div>
            <div class="form-group">
              <label>Office Phone</label>
              <input type="tel" [(ngModel)]="profileForm.officePhone" />
            </div>
          </div>

          <button class="btn-primary" (click)="saveProfile()" [disabled]="isSaving()">
            {{ isSaving() ? 'Saving...' : 'Save Changes' }}
          </button>
        </div>

        <!-- Notifications Tab -->
        <div *ngIf="activeTab() === 'notifications'" class="settings-section">
          <h2 class="section-title">Notification Preferences</h2>
          <div class="settings-list">
            <div class="setting-item">
              <div>
                <h3>Email Notifications</h3>
                <p>Receive notifications via email</p>
              </div>
              <label class="toggle">
                <input type="checkbox" [(ngModel)]="notificationSettings.emailNotifications" />
                <span class="slider"></span>
              </label>
            </div>
            <div class="setting-item">
              <div>
                <h3>SMS Notifications</h3>
                <p>Receive notifications via SMS</p>
              </div>
              <label class="toggle">
                <input type="checkbox" [(ngModel)]="notificationSettings.smsNotifications" />
                <span class="slider"></span>
              </label>
            </div>
            <div class="setting-item">
              <div>
                <h3>Appointment Reminders</h3>
                <p>Get reminders for upcoming appointments</p>
              </div>
              <label class="toggle">
                <input type="checkbox" [(ngModel)]="notificationSettings.appointmentReminders" />
                <span class="slider"></span>
              </label>
            </div>
            <div class="setting-item">
              <div>
                <h3>Message Notifications</h3>
                <p>Get notified when you receive new messages</p>
              </div>
              <label class="toggle">
                <input type="checkbox" [(ngModel)]="notificationSettings.messageNotifications" />
                <span class="slider"></span>
              </label>
            </div>
          </div>
          <button class="btn-primary" (click)="saveSettings()" [disabled]="isSaving()">
            {{ isSaving() ? 'Saving...' : 'Save Changes' }}
          </button>
        </div>

        <!-- Availability Tab -->
        <div *ngIf="activeTab() === 'availability'" class="settings-section">
          <h2 class="section-title">Availability Settings</h2>
          <div class="form-group">
            <label>Available Days</label>
            <div class="days-selector">
              <button
                *ngFor="let day of ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday']"
                class="day-btn"
                [class.active]="availabilitySettings.availableDays.includes(day)"
                (click)="toggleDay(day)"
              >
                {{ day.substring(0, 3) }}
              </button>
            </div>
          </div>
          <div class="form-grid">
            <div class="form-group">
              <label>Start Time</label>
              <input type="time" [(ngModel)]="availabilitySettings.startTime" />
            </div>
            <div class="form-group">
              <label>End Time</label>
              <input type="time" [(ngModel)]="availabilitySettings.endTime" />
            </div>
            <div class="form-group">
              <label>Appointment Duration (minutes)</label>
              <input type="number" [(ngModel)]="availabilitySettings.appointmentDuration" min="15" step="15" />
            </div>
          </div>
          <button class="btn-primary" (click)="saveSettings()" [disabled]="isSaving()">
            {{ isSaving() ? 'Saving...' : 'Save Changes' }}
          </button>
        </div>

        <!-- Billing Tab -->
        <div *ngIf="activeTab() === 'billing'" class="settings-section">
          <h2 class="section-title">Billing Settings</h2>
          <div class="form-grid">
            <div class="form-group">
              <label>Consultation Fee</label>
              <input type="number" [(ngModel)]="billingSettings.consultationFee" min="0" step="0.01" />
            </div>
            <div class="form-group">
              <label>Payment Method</label>
              <select [(ngModel)]="billingSettings.paymentMethod">
                <option value="">Select payment method</option>
                <option value="cash">Cash</option>
                <option value="card">Card</option>
                <option value="insurance">Insurance</option>
              </select>
            </div>
          </div>
          <button class="btn-primary" (click)="saveSettings()" [disabled]="isSaving()">
            {{ isSaving() ? 'Saving...' : 'Save Changes' }}
          </button>
        </div>

        <!-- Privacy Tab -->
        <div *ngIf="activeTab() === 'privacy'" class="settings-section">
          <h2 class="section-title">Privacy & Security</h2>
          <div class="settings-list">
            <div class="setting-item">
              <div>
                <h3>Two-Factor Authentication</h3>
                <p>Add an extra layer of security to your account</p>
              </div>
              <label class="toggle">
                <input type="checkbox" [(ngModel)]="privacySettings.twoFactorAuth" />
                <span class="slider"></span>
              </label>
            </div>
            <div class="setting-item">
              <div>
                <h3>Share Data with Patients</h3>
                <p>Allow patients to view their medical records</p>
              </div>
              <label class="toggle">
                <input type="checkbox" [(ngModel)]="privacySettings.shareDataWithPatients" />
                <span class="slider"></span>
              </label>
            </div>
          </div>
          <button class="btn-primary" (click)="saveSettings()" [disabled]="isSaving()">
            {{ isSaving() ? 'Saving...' : 'Save Changes' }}
          </button>
        </div>
      </div>
    </div>
  </main>
</div>
