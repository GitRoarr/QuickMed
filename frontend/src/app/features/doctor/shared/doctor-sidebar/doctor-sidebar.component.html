<aside class="doctor-sidebar" [class.sidebar-open]="isOpen" [class.sidebar-closed]="!isOpen">

  <!-- Close Button (mobile) -->
  <button type="button" class="close-btn" (click)="closeSidebar()" aria-label="Close sidebar">
    <i class="bi bi-x-lg"></i>
  </button>

  <!-- Brand -->
  <div class="sidebar-brand">
    <a routerLink="/doctor/dashboard" (click)="onLogoClick($event)" class="brand-link">
      <div class="brand-icon">
        <img src="assets/images/QuickMed-Logo.png" alt="QuickMed Logo" />
      </div>
      <div class="brand-text">
        <h3 class="brand-title">QuickMed</h3>
        <p class="brand-subtitle">Doctor Portal</p>
      </div>
    </a>
  </div>

  <!-- Navigation -->
  <ng-container *ngIf="!loading(); else sidebarSkeleton">
    <nav class="sidebar-nav">
      <a *ngFor="let item of menuItems()" [routerLink]="item.route" routerLinkActive="nav-active"
        (click)="closeSidebar()" class="nav-item">
        <ng-container *ngIf="item.imgSrc; else iconTpl">
          <img
            [src]="item.label === 'Prescriptions' && themeService.isDarkMode() ? 'assets/images/icons8-pill-50.png' : item.imgSrc"
            alt="{{ item.label }}" class="nav-item-img sidebar-pill-icon" />
        </ng-container>
        <ng-template #iconTpl>
          <i [class]="'bi ' + (item.icon || '') + ' nav-item-icon'"></i>
        </ng-template>
        <span class="nav-item-label">{{ item.label }}</span>
        <span *ngIf="item.badge && item.badge > 0" class="nav-badge">
          {{ item.badge }}
        </span>
      </a>
    </nav>
  </ng-container>

  <ng-template #sidebarSkeleton>
    <nav class="sidebar-nav">
      <div *ngFor="let _ of [1,2,3,4,5,6,7,8]" class="skeleton-item">
        <span class="skeleton-icon"></span>
        <span class="skeleton-text"></span>
      </div>
    </nav>
  </ng-template>

  <!-- User Profile Section -->
  <div class="sidebar-profile">
    <div class="profile-card">
      <div class="profile-avatar">
        <img *ngIf="currentUser()?.avatar; else docInitials" [src]="currentUser()?.avatar" class="avatar-img" />
        <ng-template #docInitials>
          <span class="avatar-initials">{{ getDoctorInitials() }}</span>
        </ng-template>
        <span class="avatar-status"></span>
      </div>
      <div class="profile-info">
        <p class="profile-name">Dr. {{ getDoctorName() }}</p>
        <p class="profile-specialty">{{ getDoctorSpecialty() }}</p>
      </div>
    </div>
    <button (click)="logout()" class="logout-btn" title="Sign out">
      <i class="bi bi-box-arrow-right"></i>
      <span>Logout</span>
    </button>
  </div>
</aside>