<aside class="doctor-sidebar" [class.sidebar-open]="isOpen" [class.sidebar-closed]="!isOpen">

  <!-- Close Button (mobile) -->
  <button type="button" class="close-btn" (click)="closeSidebar()" aria-label="Close sidebar">
    <i class="bi bi-x-lg"></i>
  </button>

  <!-- Brand Header -->
  <div class="sidebar-brand">
    <a routerLink="/doctor/dashboard" (click)="onLogoClick($event)" class="brand-link">
      <div class="brand-header">
        <div class="brand-logo-wrapper">
          <img src="assets/images/QuickMed-Logo-Light.png" alt="QuickMed Logo" />
        </div>
        <div class="brand-portal-badge">
          <span class="portal-dot"></span>
          <span class="portal-text">Doctor Portal</span>
        </div>
      </div>
    </a>
  </div>

  <div class="sidebar-divider"></div>

  <!-- Navigation -->
  <ng-container *ngIf="!loading(); else sidebarSkeleton">
    <nav class="sidebar-nav">
      <a *ngFor="let item of menuItems()" [routerLink]="item.route" routerLinkActive="nav-active"
        (click)="closeSidebar()" class="nav-item">
        <div class="nav-icon-wrapper">
          <ng-container *ngIf="item.imgSrc; else iconTpl">
            <img
              [src]="item.label === 'Prescriptions' && themeService.isDarkMode() ? 'assets/images/icons8-pill-50.png' : item.imgSrc"
              alt="{{ item.label }}" class="nav-item-img sidebar-pill-icon" />
          </ng-container>
          <ng-template #iconTpl>
            <i [class]="'bi ' + (item.icon || '') + ' nav-item-icon'"></i>
          </ng-template>
        </div>
        <span class="nav-item-label">{{ item.label }}</span>
        <span *ngIf="item.badge && item.badge > 0" class="nav-badge">
          {{ item.badge }}
        </span>
      </a>
    </nav>
  </ng-container>

  <ng-template #sidebarSkeleton>
    <nav class="sidebar-nav">
      <div *ngFor="let _ of [1,2,3,4,5,6,7,8]" class="skeleton-item">
        <span class="skeleton-icon"></span>
        <span class="skeleton-text"></span>
      </div>
    </nav>
  </ng-template>

  <div class="sidebar-divider"></div>

  <!-- Profile Card -->
  <div class="sidebar-profile">
    <div class="profile-card">
      <div class="profile-avatar">
        <img *ngIf="currentUser()?.avatar; else docInitials" [src]="currentUser()?.avatar" class="avatar-img" />
        <ng-template #docInitials>
          <span class="avatar-initials">{{ getDoctorInitials() }}</span>
        </ng-template>
        <span class="avatar-status"></span>
      </div>
      <div class="profile-info">
        <p class="profile-name">Dr. {{ getDoctorName() }}</p>
        <p class="profile-specialty">{{ getDoctorSpecialty() }}</p>
      </div>
      <button (click)="logout()" class="profile-logout-btn" title="Sign out">
        <i class="bi bi-box-arrow-right"></i>
      </button>
    </div>
  </div>
</aside>