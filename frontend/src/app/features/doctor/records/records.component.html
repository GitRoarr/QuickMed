<div class="doctor-records">
  <!-- Sidebar -->
  <aside class="sidebar">
    <div class="sidebar-header">
      <div class="logo">
        <div class="logo-icon">
          <img src="assets/images/QuickMed-Logo.png" alt="QuickMed Logo" class="h-8 w-8 rounded" />
        </div>
        <div class="logo-text">
          <h3>QuickMed</h3>
          <p>Doctor Portal</p>
        </div>
      </div>
    </div>

            <nav class="sidebar-nav">
              <a
                *ngFor="let item of menuItems()"
                [routerLink]="item.route"
                routerLinkActive="active"
                class="nav-item"
              >
                <i [class]="'bi ' + item.icon"></i>
                <span>{{ item.label }}</span>
                <span *ngIf="item.badge && item.badge > 0" class="badge">{{ item.badge }}</span>
              </a>
            </nav>

    <div class="sidebar-footer">
      <div class="user-info">
        <div class="user-avatar">
          <img *ngIf="currentUser()?.avatar; else docInitials" [src]="currentUser()?.avatar" alt="Doctor avatar" />
          <ng-template #docInitials>{{ getDoctorInitials() }}</ng-template>
        </div>
        <div class="user-details">
          <p class="user-name">Dr. {{ getDoctorName() }}</p>
          <p class="user-role">{{ getDoctorSpecialty() }}</p>
        </div>
      </div>
      <button class="logout-btn" (click)="logout()">
        <i class="bi bi-box-arrow-right"></i>
        Logout
      </button>
    </div>
  </aside>

  <!-- Main Content -->
  <main class="main-content">
    <header class="content-header">
      <div>
        <h1 class="page-title">Medical Records</h1>
        <p class="page-subtitle">View and manage patient medical records and documents</p>
      </div>
      <div class="header-actions">
        <button class="btn-secondary">
          <i class="bi bi-funnel"></i>
          Filter
        </button>
        <button class="btn-primary" (click)="uploadRecord()">
          <i class="bi bi-plus-circle"></i>
          Upload Record
        </button>
      </div>
    </header>

    <!-- Search Bar -->
    <div class="search-section">
      <div class="search-input-wrapper">
        <i class="bi bi-search search-icon"></i>
        <input
          type="text"
          placeholder="Search by patient name or record type..."
          [value]="searchQuery()"
          (input)="searchQuery.set($any($event.target).value); onSearchChange()"
          class="search-input"
        />
      </div>
    </div>

    <!-- Loading State -->
    <div *ngIf="isLoading()" class="loading-container">
      <div class="spinner"></div>
      <p>Loading records...</p>
    </div>

    <!-- Records List -->
    <div *ngIf="!isLoading()" class="records-list">
      <div
        *ngFor="let record of records()"
        class="record-card"
      >
        <div class="record-header">
          <div class="record-icon">
            <i class="bi bi-file-earmark-medical"></i>
          </div>
          <div class="record-info">
            <h3 class="record-type">{{ getRecordTypeLabel(record.type) }}</h3>
            <p class="record-description">{{ record.description || record.title }}</p>
            <p class="record-patient">Patient: {{ getPatientName(record) }}</p>
          </div>
          <div class="record-status">
            <span [class]="'status-badge ' + (record.status || 'pending')">
              {{ (record.status || 'pending') | titlecase }}
            </span>
          </div>
        </div>

        <div class="record-details">
          <div class="detail-item">
            <i class="bi bi-calendar-date"></i>
            <span>Date: {{ record.recordDate | date:'yyyy-MM-dd' }}</span>
          </div>
          <div class="detail-item" *ngIf="record.fileSize">
            <i class="bi bi-file-earmark"></i>
            <span>Size: {{ formatFileSize(record.fileSize) }}</span>
          </div>
        </div>

        <div class="record-actions">
          <button class="action-btn view" (click)="viewRecord(record)">
            <i class="bi bi-eye"></i>
            View Record
          </button>
          <button class="action-btn download" (click)="downloadRecord(record)">
            <i class="bi bi-download"></i>
            Download
          </button>
          <button class="action-btn delete" (click)="deleteRecord(record)">
            <i class="bi bi-trash"></i>
            Delete
          </button>
        </div>
      </div>

      <div *ngIf="records().length === 0" class="empty-state">
        <i class="bi bi-file-earmark-medical"></i>
        <p>No medical records found</p>
      </div>
    </div>
  </main>
</div>
