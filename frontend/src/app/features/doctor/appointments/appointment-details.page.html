<!-- Modal Overlay -->
<div class="modal-overlay">
  <div class="modal-card animated-modal">
    <div class="flex items-center gap-4 mb-6">
      <div class="avatar-lg shadow-lg" [style.background-image]="appointment.patient.avatar ? 'url(' + appointment.patient.avatar + ')' : ''">
        <span *ngIf="!appointment.patient.avatar">{{ getInitials(appointment.patient) }}</span>
      </div>
      <div>
        <div class="font-bold text-2xl text-primary flex items-center gap-2">
          {{ appointment.patient.name }}
          <span class="badge badge-success">{{ appointment.status | titlecase }}</span>
        </div>
        <div class="text-muted text-sm">Age: {{ appointment.patient.age }} • {{ appointment.patient.email }}</div>
        <div class="text-xs text-muted">Last seen: {{ appointment.patient.lastSeen | date:'MMM d, y' }}</div>
      </div>
    </div>
    <div class="grid grid-cols-2 md:grid-cols-3 gap-4 mb-6">
      <div class="stat-card gradient-card">Appointment ID<br><span class="font-bold">{{ appointment.id }}</span></div>
      <div class="stat-card gradient-card">Date & Time<br><span class="font-bold">{{ appointment.date | date:'MMM d, y - h:mm a' }}</span></div>
      <div class="stat-card gradient-card">Status<br><span class="badge badge-info">{{ appointment.status | titlecase }}</span></div>
    </div>
    <div class="card mb-4 shadow-md">Chief Complaint: <span class="font-semibold text-danger">{{ appointment.chiefComplaint }}</span></div>
    <div class="grid grid-cols-2 md:grid-cols-3 gap-4 mb-6">
      <div class="stat-card gradient-card">Heart Rate<br><span class="font-bold">{{ appointment.vitals.heartRate }} bpm</span></div>
      <div class="stat-card gradient-card">Temperature<br><span class="font-bold">{{ appointment.vitals.temperature }}°C</span></div>
      <div class="stat-card gradient-card">SpO2<br><span class="font-bold">{{ appointment.vitals.spO2 }}%</span></div>
    </div>
    <div class="card mb-4 shadow-md">
      <div class="font-bold mb-2 text-primary">Doctor Notes & Diagnosis</div>
      <span class="font-semibold">{{ appointment.diagnosis }}</span>
    </div>
    <div class="card mb-4 shadow-md">
      <div class="font-bold mb-2 text-primary">Prescription</div>
      <table class="w-full prescription-table">
        <thead>
          <tr><th>Medicine</th><th>Dosage</th><th>Frequency</th><th>Duration</th></tr>
        </thead>
        <tbody>
          <tr *ngFor="let rx of appointment.prescription">
            <td>{{ rx.medicine }}</td>
            <td>{{ rx.dosage }}</td>
            <td>{{ rx.frequency }}</td>
            <td>{{ rx.duration }}</td>
          </tr>
        </tbody>
      </table>
    </div>
    <div class="card mb-4 shadow-md">
      <div class="flex items-center justify-between mb-2">
        <span class="font-bold text-primary text-lg">Appointments</span>
        <span class="badge badge-success">{{ appointments.length }}</span>
      </div>
      <div *ngIf="appointments.length > 0; else noAppointments">
        <div *ngFor="let appt of appointments" class="appointment-list-item gradient-card">
          <div class="flex items-center gap-2">
            <span class="font-bold">{{ appt.title || appt.type }}</span>
            <span class="badge badge-info">{{ appt.status | titlecase }}</span>
          </div>
          <div class="text-muted text-xs">{{ appt.date | date:'MMM d, y - h:mm a' }}</div>
          <div class="flex gap-2 mt-2">
            <button class="btn btn-sm btn-primary">View</button>
            <button class="btn btn-sm btn-ghost">Reschedule</button>
          </div>
        </div>
      </div>
      <ng-template #noAppointments>
        <div class="empty-state">No appointments found.</div>
      </ng-template>
    </div>
    <div class="flex gap-2 justify-end mt-6">
      <button class="btn-ghost btn btn-lg">Download Report</button>
      <button class="btn btn-lg btn-primary">Book Follow-up</button>
      <button class="btn btn-lg btn-danger" (click)="closeModal()">Close</button>
    </div>
  </div>
</div>
