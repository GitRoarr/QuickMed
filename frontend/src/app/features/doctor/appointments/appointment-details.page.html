<main class="modal-overlay" aria-label="Appointment Details">
  <section class="modal-card" tabindex="0">
    <!-- Header: Patient info -->
    <header class="modal-header">
      <div class="avatar-lg" [style.background-image]="appointment.patient?.avatar ? 'url(' + appointment.patient.avatar + ')' : ''" aria-label="Patient Avatar">
        <span *ngIf="!appointment.patient?.avatar">{{ getInitials(appointment.patient) }}</span>
      </div>
      <div class="patient-info">
        <h1 class="patient-name">
          {{ appointment.patient?.name }}
          <span class="badge" [ngClass]="{
            'badge-success': appointment.status === 'completed',
            'badge-danger': appointment.status === 'cancelled',
            'badge-info': appointment.status === 'pending'
          }">
            {{ appointment.status | titlecase }}
          </span>
        </h1>
        <p class="patient-meta">Age: {{ appointment.patient?.age }} â€¢ {{ appointment.patient?.email }}</p>
        <p class="patient-meta">Last seen: {{ appointment.patient?.lastSeen | date:'MMM d, y' }}</p>
      </div>
    </header>

    <!-- Appointment Stats -->
    <section class="stats-grid" aria-label="Appointment Statistics">
      <div class="stat-card gradient-card">
        <p class="stat-title">Appointment ID</p>
        <p class="stat-value">{{ appointment.id }}</p>
      </div>
      <div class="stat-card gradient-card">
        <p class="stat-title">Date & Time</p>
        <p class="stat-value">{{ appointment.date | date:'MMM d, y - h:mm a' }}</p>
      </div>
      <div class="stat-card gradient-card">
        <p class="stat-title">Status</p>
        <span class="badge" [ngClass]="{
          'badge-success': appointment.status === 'completed',
          'badge-danger': appointment.status === 'cancelled',
          'badge-info': appointment.status === 'pending'
        }">
          {{ appointment.status | titlecase }}
        </span>
      </div>
    </section>

    <!-- Doctor Notes -->
    <section class="card section-card">
      <h2>Doctor Notes & Diagnosis</h2>
      <p>{{ appointment.diagnosis || 'No notes available.' }}</p>
    </section>

    <!-- Prescription -->
    <section class="card section-card">
      <h2>Prescription</h2>
      <table class="prescription-table" aria-label="Prescription Table">
        <thead>
          <tr>
            <th scope="col">Medicine</th>
            <th scope="col">Dosage</th>
            <th scope="col">Frequency</th>
            <th scope="col">Duration</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let rx of appointment.prescription">
            <td>{{ rx.medicine }}</td>
            <td>{{ rx.dosage }}</td>
            <td>{{ rx.frequency }}</td>
            <td>{{ rx.duration }}</td>
          </tr>
        </tbody>
      </table>
      <p *ngIf="!appointment.prescription?.length" class="empty-state">No prescriptions found.</p>
    </section>

    <!-- Actions -->
    <nav class="modal-actions" aria-label="Actions">
      <button class="btn btn-download" tabindex="0">Download Report</button>
      <button class="btn btn-close" (click)="emitCloseModal()" tabindex="0">Close</button>
    </nav>
  </section>
</main>
