<aside class="sidebar" [class.collapsed]="sidebarCollapsed()">
  <div class="sidebar-header">
    <h3>{{ title }}</h3>
    <button (click)="toggleSidebar()">
      <i class="bi" [class.bi-chevron-left]="!sidebarCollapsed()" [class.bi-chevron-right]="sidebarCollapsed()"></i>
    </button>
  </div>

  <div class="user-section">
    <label class="avatar-wrapper">
      <div class="avatar" *ngIf="!currentUser()?.avatar">{{ getInitials(currentUser()?.firstName, currentUser()?.lastName) }}</div>
      <img *ngIf="currentUser()?.avatar" [src]="currentUser()?.avatar" alt="avatar" class="avatar">
      <input type="file" (change)="onAvatarChange($event)" hidden />
    </label>
    <div *ngIf="!sidebarCollapsed()" class="user-info">
      <p>{{ currentUser()?.firstName }} {{ currentUser()?.lastName }}</p>
      <small>{{ currentUser()?.role }}</small>
    </div>
  </div>

  <nav class="menu">
    <div *ngFor="let item of menuItems; let i = index">
      <a (click)="item.submenu ? toggleSubmenu(i) : navigate(item.route)">
        <i class="bi" [class]="item.icon"></i>
        <span *ngIf="!sidebarCollapsed()">{{ item.label }}</span>
        <i *ngIf="item.submenu" class="bi" [class.bi-chevron-down]="item.expanded" [class.bi-chevron-right]="!item.expanded"></i>
      </a>
      <div *ngIf="item.submenu && item.expanded" class="submenu">
        <a *ngFor="let sub of item.submenu" (click)="navigate(sub.route)">
          <i class="bi" [class]="sub.icon"></i>
          <span>{{ sub.label }}</span>
        </a>
      </div>
    </div>
  </nav>

  <div class="sidebar-footer">
    <button (click)="toggleTheme()">
      <i class="bi" [class.bi-sun]="!isDarkMode()" [class.bi-moon]="isDarkMode()"></i>
      <span *ngIf="!sidebarCollapsed()">Theme</span>
    </button>
    <button (click)="openSettings()">
      <i class="bi bi-gear"></i>
      <span *ngIf="!sidebarCollapsed()">Settings</span>
    </button>
    <button (click)="logout()">
      <i class="bi bi-box-arrow-right"></i>
      <span *ngIf="!sidebarCollapsed()">Logout</span>
    </button>
  </div>
</aside>
